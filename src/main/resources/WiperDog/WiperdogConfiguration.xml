<?xml version="1.0" encoding="UTF-8"?>

<xwikidoc>
  <web>WiperDog</web>
  <name>WiperdogConfiguration</name>
  <language/>
  <defaultLanguage/>
  <translation>0</translation>
  <parent>WiperDog.WebHome</parent>
  <creator>xwiki:XWiki.Admin</creator>
  <author>xwiki:XWiki.Admin</author>
  <customClass/>
  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>
  <creationDate>1382327524000</creationDate>
  <date>1387523877000</date>
  <contentUpdateDate>1387523877000</contentUpdateDate>
  <version>1.1</version>
  <title>WiperdogConfiguration</title>
  <defaultTemplate/>
  <validationScript/>
  <comment/>
  <minorEdit>false</minorEdit>
  <syntaxId>xwiki/2.1</syntaxId>
  <hidden>false</hidden>
  <object>
    <class>
      <name>XWiki.JavaScriptExtension</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <cache>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>0</multiSelect>
        <name>cache</name>
        <number>5</number>
        <prettyName>Caching policy</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators> ,|</separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>long|short|default|forbid</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </cache>
      <code>
        <disabled>0</disabled>
        <name>code</name>
        <number>2</number>
        <prettyName>Code</prettyName>
        <rows>20</rows>
        <size>50</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </code>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <parse>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>parse</name>
        <number>4</number>
        <prettyName>Parse content</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </parse>
      <use>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>0</multiSelect>
        <name>use</name>
        <number>3</number>
        <prettyName>Use this extension</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators> ,|</separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>currentPage=Always on this page|onDemand=On demand|always=Always on this wiki</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </use>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>0</number>
    <className>XWiki.JavaScriptExtension</className>
    <guid>563a5377-8f15-4185-b704-cd9d1efab1e9</guid>
    <property>
      <cache>long</cache>
    </property>
    <property>
      <code>require(['jquery'],function($){

  function deleteRow(r){
    var i=r.parentNode.parentNode.rowIndex;
    var row = r.parentNode.parentNode
    document.getElementById('table_display').deleteRow(i);
    return row
  }

  function editRow(r){
    var row = r.parentNode.parentNode
    var key_edit= row.cells[0].innerText || row.cells[0].textContent
    $("#name").val(key_edit)
    var host_txt = row.cells[1].innerText || row.cells[1].textContent
    $("#host").val(host_txt)
    var port_txt = row.cells[2].innerText || row.cells[2].textContent
    $("#port").val(port_txt)
    var servlet_txt = row.cells[3].innerText || row.cells[3].textContent
    $("#servlet").val(servlet_txt)
    var desc_txt = row.cells[4].innerText || row.cells[4].textContent
    $("#desc").val(desc_txt)
  }
  
  // send data to process
  function sendData(result){
     var data2send = JSON.stringify(result)
     $("#result").val(data2send)
  }
  
  var td_desc_width = ($("#desc").parent().width())
  $("#desc").width(td_desc_width)
  var name = null
  var hostName = null
  var port = null
  var servlet = null
  var desc = null
  if($("#result").text() != null){
     var result = $.parseJSON($("#result").text())
  }
  
  if(result == null || (result instanceof Array)){
    result = {}
  }
  $("#name").focus()
  
  var beforeOS = null
  var beforeHost = null
  $(document).ready(function() {
        $.ajax({
	   type:"GET",
	   url: "/xwiki/bin/get/WiperDog/ControlProcess?outputSyntax=plain&amp;action=read",
	   dataType: "json",
	   crossDomain: true,
	   success: function(result){
              if(result.data != null &amp;&amp; result.data != ''){
                beforeOS = result.data.os
                beforeHost = result.data.host
                $('#remoteHost').val(result.data.host)
                if(result.data.os == 'win' &amp;&amp; result.data.host != 'localhost'){
                  $('.u').show(400)
                  $('.p').show(400)
                } else {
                 if(result.data.os == 'linux' &amp;&amp; result.data.host != 'localhost'){
                     $('.u').show(400)
                     $('.p').hide(400)
                 } else {
                      if(result.data.host == "localhost"){
                           $('.u').hide(400)
                           $('.p').hide(400)
                      }
                 }
                }
                $('#uName').val((result.data.user).replace('/','\\'))
                $('#passwd').val(result.data.pass)
                if(result.data.os == 'linux'){
                  $("input:radio[name=os][value=linux]").prop("checked",true)
                  $('#dir').val(result.data.path)
                } else {
                  $("input:radio[name=os][value=win]").prop("checked",true)
                  $('#dir').val((result.data.path).replace(/\//g,'\\'))
                }
                if(result.data.host == 'localhost' || result.data.host == '127.0.0.1'){  
                  $("input:radio[name=hostSelect][value=local]").prop("checked",true)
                  $('#remoteHost').hide()
                } else {
                  $("input:radio[name=hostSelect][value=other]").prop("checked",true)
                }
              } else {
                $('#remoteHost').val('')
                $('#remoteHost').hide()
                $('#uName').val('')
                $('#passwd').val('')
                $('#dir').val('')
                $("input:radio[name=os][value=linux]").prop("checked",true)
                $("input:radio[name=hostSelect][value=local]").prop("checked",true)
              }
	   },
	   error: function (xhr,status,error){
		console.log(xhr)
		console.log(status)
		console.log(error)
	   }
       });
  })
  $("#add").click(function(){
     name = $("#name").val()
     if(name === ""){
        $("#message").text("Name can not be empty !")
          return
     } else {
            $("#message").text("")
     }

     hostName = $("#host").val()
     if(hostName === ""){
        $("#message").text("Host name can not be empty !")
          return
     } else {
        $("#message").text("")
     }
     port = $("#port").val()
     var intRegex = /^\d+$/;
     if(port === ""){
        $("#message").text("Port can not be empty !")
        return
     } else {
        if(!intRegex.test(port)){
            $("#message").text("Port must be numeric !")
             return
        }else{
            $("#message").text("")
        }
     }
     servlet= $("#servlet").val()
     if(servlet === ""){
        $("#message").text("Servlet can not be empty !")
         return
     } else {
        if(servlet.indexOf("/") === 0 || servlet.charAt(servlet.length - 1) == '/') {
           $("#message").text("Servlet can not start or end with '/' character  !")
            return
        } else {
          $("#message").text("")
        }
     }
    desc = $("#desc").val()
     if(desc === null){
       desc = ""

     }
     var key = name
     var value_servlet = "http://" + hostName + ":" + port + "/" + servlet
     var update = false
     for(key_res in result ){
       if(key === key_res){
       update = true
       break
     }
   }
  if(update){
     var confirm_update = confirm("Name exists ,want to update ?")
     if(confirm_update){
       var rows = document.getElementById('table_display').rows
       for(var i = 0 ; i &lt; rows.length ; i++) {
         var key2remove = rows[i].cells[0].innerText || rows[i].cells[0].textContent
         if(key == key2remove ){
          rows[i].cells[1].innerText = $("#host").val()
          rows[i].cells[1].textContent = $("#host").val()
          rows[i].cells[2].innerText = $("#port").val()
          rows[i].cells[2].textContent = $("#port").val()
          rows[i].cells[3].innerText = $("#servlet").val()
          rows[i].cells[3].textContent = $("#servlet").val()
          rows[i].cells[4].innerText = $("#desc").val()
          rows[i].cells[4].textContent = $("#desc").val()
          $("#message").text('Update succefully !')
          $("#name").prop('disabled',false)
          $("#name").val("")
          $("#host").val("")
          $("#port").val("")
          $("#servlet").val("")
          $("#desc").val("")
         }
       }
    }
  } else {
    var tr2 = document.createElement('tr')
    var td_name2 = document.createElement('td')
    var inp_name2 = document.createTextNode(name)
    td_name2.appendChild(inp_name2)
    var td_host2 = document.createElement('td')
    var inp_host2 = document.createTextNode(hostName)
    td_host2.appendChild(inp_host2)
    var td_port2 = document.createElement('td')
    var inp_port2 = document.createTextNode(port)
    td_port2.appendChild(inp_port2)
    var td_servlet2 = document.createElement('td')
    var inp_servlet2 = document.createTextNode(servlet)
    var td_desc = document.createElement('td')
    var inp_desc = document.createTextNode(desc)
               
    var btn_delete = document.createElement('input')
     btn_delete.setAttribute('type','button')
     btn_delete.setAttribute('style','width:50px')
     btn_delete.setAttribute('value','Delete')
     btn_delete.setAttribute('class','delete button')
    var btn_edit = document.createElement('input')
     btn_edit.setAttribute('type','button')
     btn_edit.setAttribute('class','edit button')
     btn_edit.setAttribute('value','Edit')
     btn_edit.setAttribute('style','width:50px')
    var td_action = document.createElement('td')
      td_action.appendChild(btn_delete)
      td_action.appendChild(btn_edit)
      td_servlet2.appendChild(inp_servlet2)
                  td_desc.appendChild(inp_desc)
    tr2.appendChild(td_name2)
    tr2.appendChild(td_host2)
    tr2.appendChild(td_port2)
    tr2.appendChild(td_servlet2)
                tr2.appendChild(td_desc)
    tr2.appendChild(td_action)
               $(tr2).insertBefore($("#input"))
    $("#name").val("")
    $("#host").val("")
    $("#port").val("")
    $("#servlet").val("")
    $("#desc").val("")

     }
     result[key] = {}
     result[key]['servlet'] = value_servlet
     result[key]['desc'] = desc
     sendData(result)

  });
   $(document).on('click','.delete',function(){
    var conf_del = confirm("Are you sure ?")
    if(conf_del){
      var row = deleteRow(this)
      var key_remove = row.cells[0].innerText || row.cells[0].textContent
			delete result[key_remove]
      sendData(result)
      if($("#name").text() === key_remove) {
         $("#name").prop('disabled',false)
      }

    }
  })
  $(document).on('click','.edit',function(){
      editRow(this)
      $("#name").prop('disabled',true)
  })
  
  var userName = ''
  var password = ''
  var wdHome = ''
  var remoteHost = ''
  var os = ''
  var host = ''

  // Host select
  //var beforeHost= $("input:radio[name=hostSelect]:checked").val()
  $("input:radio[name=hostSelect]").click(function() { 
         var value = $(this).val()
         var os = $("input:radio[name=os]:checked").val()
         if (beforeHost != value &amp;&amp; value == 'other') {
		$("#remoteHost").show(400);
                if(os == 'win'){
			$(".p").show(400)
                } else {
                        $(".p").hide(400)
                }
			$(".u").show(400)
	 } else {
             if(beforeHost != value ){
		$("#remoteHost").hide(400)
			$(".u").hide(400)
			$(".p").hide(400)		
             }
	 }
     beforeHost= value
  });
  
  // Select Operating System
  //var beforeOS = $("input:radio[name=os]:checked").val()
  $("input:radio[name=os]").click(function() {
	var value = $(this).val()
        host = $("input[name=hostSelect]:checked").val()
	if (beforeOS != value &amp;&amp; checkDirtyAll()) {
		var conf = confirm("Your data input will be reset ! Continue ?")
		if (conf) {
			resetAll()
		} else {
                       	if (value == 'win' &amp;&amp; host != 'local') {
		           $('.u').show(400)
		           $('.p').show(400)
                        } else {
	                   $('.u').show(400)
	                   $('.p').hide(400)
		        }        
			return
		}
	}
	if (value == 'win' &amp;&amp; host == 'other') {
		$('.u').show(400)
		$('.p').show(400)
	} else {
            if( value == 'linux' &amp;&amp; host == 'other'){
	        $('.u').show(400)
              } else {
                $('.u').hide(400) 
              }
	        $('.p').hide(400)
	}
    beforeOS = value
  });
  //reset data inputtext
  function resetAll() {
    $("#remoteHost").val("")
    $("#uName").val("")
    $("#passwd").val("")
    $("#dir").val("")
  }

  //Check all values of text fields
  function checkDirtyAll() {
    userName = $.trim($("#uName").val())
    password = $.trim($("#passwd").val())
    wdHome = $.trim($("#dir").val())
    remoteHost = $.trim($("#remoteHost").val())
    if (userName != "" || password != "" || wdHome != "" || remoteHost != "") {
	return true
    } else {
	return false
    }
  }

  //validate data when click button update
  $("#updateWDPath").click(function(){
    var regexIP = /^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/
    os = $("input:radio:checked[name=os]").val()
    host = $("input[name=hostSelect]:checked").val()
    wdHome = $.trim($("#dir").val())
    userName = ''
    password = ''
    if(host == 'other'){
      remoteHost = $.trim($("#remoteHost").val())
      if(os == 'win'){
        password = $.trim($("#passwd").val())
      }
        userName = $.trim($("#uName").val())
    }
    if(host == 'local'){
      remoteHost = 'localhost'
    }
    //validate with os linux
    if(remoteHost == '' &amp;&amp; os == 'linux' &amp;&amp; host == 'other') {
      $("#messageWiperdog").show()
      $("#messageWiperdog").text('Host IP can not be empty!!!')
      return false
    }
    if( host == 'other' &amp;&amp; !regexIP.test(remoteHost)) {
      $("#messageWiperdog").show()
      $("#messageWiperdog").text("Host IP is not valid !")                    
      return false
    } else {
      $("#messageWiperdog").text("")
    }
    //validate with os window
    if(os == 'win' &amp;&amp; host == 'other') {
      if(remoteHost == ''){
        $("#messageWiperdog").show()
        $("#messageWiperdog").text('Host IP can not be empty!!!')
        return false
      }
      if(userName == ''){
        $("#messageWiperdog").show()
        $("#messageWiperdog").text('User connect can not be empty!!!')
        return false
      }
      if(password == ''){
        $("#messageWiperdog").show()
        $("#messageWiperdog").text('Password connect can not be empty!!!')
        return false
      }
    }
    //validate wiperdog home
    if(wdHome == '') {
      $("#messageWiperdog").show()
      $("#messageWiperdog").text('Wiperdog Home can not be empty!!!')
      return false
    }

    var dataResult = {}
    dataResult['os'] = os
    dataResult['host'] = remoteHost
    dataResult['user'] = userName
    dataResult['pass'] = password
    dataResult['path'] = wdHome
    dataResult['installSysService'] = $("#installSysService").is(":checked")

    var data2send = {}
    data2send["data"] = JSON.stringify(dataResult)
    $("#messageWiperdog").show()
    $("#messageWiperdog").text('Processing...')
    console.log(JSON.stringify(data2send))
    $.ajax({
	type:"POST",
	url: "/xwiki/bin/get/WiperDog/ControlProcess?outputSyntax=plain&amp;action=write&amp;cont=",
	dataType: "json",
	data: data2send ,
	crossDomain: true,
	success: function(result){
            $("#messageWiperdog").show()
            $("#messageWiperdog").text(result.message)
            if(result.status == 1){
                var conf= confirm("Are you want to update file conf.params?")
                if(conf){
                    $.ajax({
            	  type:"POST",
	              url: "/xwiki/bin/get/WiperDog/ControlProcess?outputSyntax=plain&amp;action=write&amp;cont=yes",
            	      dataType: "json",
            	      data: data2send ,
            	      crossDomain: true,
  	              success: function(result){
                         $("#messageWiperdog").text(result.message)
                      }
                    })
               } else {
                  $("#messageWiperdog").text('Failed to update wiperdog config!!!')
               }
            }
	},
	error: function (xhr,status,error){
		console.log(xhr)
		console.log(status)
		console.log(error)
                $("#messageWiperdog").text('Failed to update wiperdog config!!!')
	}
    });
  })
jQuery.noConflict()
});</code>
    </property>
    <property>
      <name>process</name>
    </property>
    <property>
      <parse/>
    </property>
    <property>
      <use>currentPage</use>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.StyleSheetExtension</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <cache>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>0</multiSelect>
        <name>cache</name>
        <number>5</number>
        <prettyName>Caching policy</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators> ,|</separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>long|short|default|forbid</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </cache>
      <code>
        <disabled>0</disabled>
        <name>code</name>
        <number>2</number>
        <prettyName>Code</prettyName>
        <rows>20</rows>
        <size>50</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </code>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <parse>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>parse</name>
        <number>4</number>
        <prettyName>Parse content</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </parse>
      <use>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>0</multiSelect>
        <name>use</name>
        <number>3</number>
        <prettyName>Use this extension</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators> ,|</separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>currentPage=Always on this page|onDemand=On demand|always=Always on this wiki</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </use>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>0</number>
    <className>XWiki.StyleSheetExtension</className>
    <guid>3047e03e-809e-498f-953a-a1bad217aa91</guid>
    <property>
      <cache>long</cache>
    </property>
    <property>
      <code>#form{
float:left
}
.message{
 margin-left:200px;
 font-weight:bold;
 color:green;
display: block
}

.header{
display:block ;
font-weight: bold ;
font-size: 1.5em
}
label{
 font-size: 1.2em;
 font-weight: bold
}
#dir{
 width: 500px
}</code>
    </property>
    <property>
      <name>css</name>
    </property>
    <property>
      <parse/>
    </property>
    <property>
      <use>currentPage</use>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.StyleSheetExtension</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <cache>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>0</multiSelect>
        <name>cache</name>
        <number>5</number>
        <prettyName>Caching policy</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators> ,|</separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>long|short|default|forbid</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </cache>
      <code>
        <disabled>0</disabled>
        <name>code</name>
        <number>2</number>
        <prettyName>Code</prettyName>
        <rows>20</rows>
        <size>50</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </code>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <parse>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>parse</name>
        <number>4</number>
        <prettyName>Parse content</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </parse>
      <use>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>0</multiSelect>
        <name>use</name>
        <number>3</number>
        <prettyName>Use this extension</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators> ,|</separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>currentPage=Always on this page|onDemand=On demand|always=Always on this wiki</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </use>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>1</number>
    <className>XWiki.StyleSheetExtension</className>
    <guid>0d00aa49-12f5-4a7a-a732-9f1ceae880f0</guid>
    <property>
      <cache>long</cache>
    </property>
    <property>
      <code/>
    </property>
    <property>
      <name/>
    </property>
    <property>
      <parse/>
    </property>
    <property>
      <use>currentPage</use>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>0</number>
    <className>XWiki.XWikiRights</className>
    <guid>b56f91a2-46f7-47ff-804a-3d1bd9ed1b62</guid>
    <property>
      <allow>1</allow>
    </property>
    <property>
      <groups/>
    </property>
    <property>
      <levels>view,edit,delete,comment</levels>
    </property>
    <property>
      <users>xwiki:XWiki.Admin</users>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>1</number>
    <className>XWiki.XWikiRights</className>
    <guid>c292f124-7685-4307-8511-42587ef0a335</guid>
    <property>
      <allow>1</allow>
    </property>
    <property>
      <groups/>
    </property>
    <property>
      <levels>view,comment</levels>
    </property>
    <property>
      <users>XWiki.XWikiGuest</users>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>2</number>
    <className>XWiki.XWikiRights</className>
    <guid>aaedc8b8-16b9-40c1-9c2c-b895021c3b24</guid>
    <property>
      <allow>1</allow>
    </property>
    <property>
      <groups>xwiki:XWiki.XWikiAdminGroup,</groups>
    </property>
    <property>
      <levels>view,edit,delete,comment</levels>
    </property>
    <property>
      <users/>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>3</number>
    <className>XWiki.XWikiRights</className>
    <guid>11720ed0-6f1d-48e9-ab56-882bcfeaa0b6</guid>
    <property>
      <allow>1</allow>
    </property>
    <property>
      <groups>xwiki:XWiki.XWikiAllGroup,</groups>
    </property>
    <property>
      <levels>view,comment</levels>
    </property>
    <property>
      <users/>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>4</number>
    <className>XWiki.XWikiRights</className>
    <guid>6faa9b9c-0055-4aaa-ac27-ba5b83c89344</guid>
    <property>
      <allow>1</allow>
    </property>
    <property>
      <groups>xwiki:XWiki.XWikiAdminGroup,</groups>
    </property>
    <property>
      <levels>view,edit,delete,comment</levels>
    </property>
    <property>
      <users/>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>6</number>
    <className>XWiki.XWikiRights</className>
    <guid>2abb04c4-65a6-4351-af7f-4bda013c323b</guid>
    <property>
      <allow>0</allow>
    </property>
    <property>
      <groups>xwiki:XWiki.XWikiAllGroup,</groups>
    </property>
    <property>
      <levels>edit,delete</levels>
    </property>
    <property>
      <users/>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>7</number>
    <className>XWiki.XWikiRights</className>
    <guid>ccf26104-c297-4e13-b1b8-2bdb80c54288</guid>
    <property>
      <allow>1</allow>
    </property>
    <property>
      <groups>xwiki:XWiki.XWikiAllGroup,</groups>
    </property>
    <property>
      <levels>view,comment</levels>
    </property>
    <property>
      <users/>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>8</number>
    <className>XWiki.XWikiRights</className>
    <guid>ea57d28f-b5ec-4daa-99ec-4252a1aac10f</guid>
    <property>
      <allow>0</allow>
    </property>
    <property>
      <groups/>
    </property>
    <property>
      <levels>edit,delete</levels>
    </property>
    <property>
      <users>XWiki.XWikiGuest</users>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>9</number>
    <className>XWiki.XWikiRights</className>
    <guid>f1c14ad6-50e5-42a3-97c1-e306c946adcc</guid>
    <property>
      <allow>1</allow>
    </property>
    <property>
      <groups>xwiki:XWiki.XWikiAdminGroup,</groups>
    </property>
    <property>
      <levels>view,edit,delete,comment</levels>
    </property>
    <property>
      <users/>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>11</number>
    <className>XWiki.XWikiRights</className>
    <guid>3d82cc02-cd73-499b-8ebc-baa2c8284196</guid>
    <property>
      <allow>0</allow>
    </property>
    <property>
      <groups>xwiki:XWiki.XWikiAllGroup,</groups>
    </property>
    <property>
      <levels>edit,delete</levels>
    </property>
    <property>
      <users/>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>12</number>
    <className>XWiki.XWikiRights</className>
    <guid>75d45768-b675-4d22-a508-00f96c69f8ce</guid>
    <property>
      <allow>1</allow>
    </property>
    <property>
      <groups>xwiki:XWiki.XWikiAllGroup,</groups>
    </property>
    <property>
      <levels>view,comment</levels>
    </property>
    <property>
      <users/>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>13</number>
    <className>XWiki.XWikiRights</className>
    <guid>cab382c0-7a5b-42ab-a67b-c825e11aa070</guid>
    <property>
      <allow>1</allow>
    </property>
    <property>
      <groups>xwiki:XWiki.XWikiAdminGroup,</groups>
    </property>
    <property>
      <levels>view,edit,delete,comment</levels>
    </property>
    <property>
      <users/>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>15</number>
    <className>XWiki.XWikiRights</className>
    <guid>7a576cce-5df7-434c-bb4d-ae68a1e4d29e</guid>
    <property>
      <allow>0</allow>
    </property>
    <property>
      <groups>xwiki:XWiki.XWikiAllGroup,</groups>
    </property>
    <property>
      <levels>edit,delete</levels>
    </property>
    <property>
      <users/>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>WiperDog.WiperdogConfiguration</name>
    <number>16</number>
    <className>XWiki.XWikiRights</className>
    <guid>b5e11e35-9b6a-4684-976a-f38db4b9a0d0</guid>
    <property>
      <allow>1</allow>
    </property>
    <property>
      <groups>xwiki:XWiki.XWikiAllGroup,</groups>
    </property>
    <property>
      <levels>view,comment</levels>
    </property>
    <property>
      <users/>
    </property>
  </object>
  <content>{{velocity}}
$xwiki.ssx.use("WiperDog.checkService")
{{/velocity}}
{{include document="WiperDog.checkService"/}}

{{groovy}}
import groovy.json.*
def servletData= request.getParameter('result')
def defaultParams= services.GetServlet.DEFAULT_CONFIG
Properties props = System.getProperties();
def xwiki_dir = props.getProperty('user.dir');

def slurper = new JsonSlurper()
def messServlet = null

def oldData = services.WiperdogConfig.getDataFromConfig()
if(servletData!= null ){
	try{
		if(oldData == null){
			oldData = [:]
		}
		if(oldData['servlet_config'] == null){
			oldData['servlet_config'] = [:]
		}
		oldData['servlet_config'] = slurper.parseText(servletData)
		
                services.WiperdogConfig.setDataToConfig(oldData)

		messServlet = "Create servlet information successfully !"
	}catch(Exception ex){
		messServlet = "{{error}}Failed to create servlet information!" + ex +"{{/error}}"
	}
}

def params = oldData
if(params == null || params == [:]) {
	params = defaultParams
}
def paramsServlet = params['servlet_config']

if(paramsServlet == null || paramsServlet == [:] ){
	paramsServlet = defaultParams['servlet_config']
} else {
	def paramsKeys = paramsServlet.keySet()
	for(key in defaultParams['servlet_config'].keySet()){
                def value = defaultParams['servlet_config'][key]
		if(!paramsKeys.contains(key)){
			paramsServlet[key] = {}
			paramsServlet[key]['servlet'] = value.servlet
			paramsServlet[key]['desc'] = value.desc
		}
	}
}

params['servlet_config'] = paramsServlet
def builder = new JsonBuilder(params['servlet_config'])
def str_json = builder.toPrettyString()

def tmp = [:]
println "{{html clean='false' wiki = 'true'}}"
println "&lt;form action='#' method='POST'&gt;"
println "&lt;div class= 'header'&gt;Servlet Configuration&lt;/div&gt;"
println "&lt;table id='table_display'&gt;"
println "&lt;tr style='text-align:center'&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Host name&lt;/th&gt;&lt;th&gt;Port&lt;/th&gt;&lt;th&gt;Servlet path&lt;/th&gt;&lt;th&gt;Description&lt;/th&gt;&lt;th&gt;Action&lt;/th&gt;&lt;/tr&gt;"
	for(key in paramsServlet.keySet()){
        def value = paramsServlet[key]
	def arr_str = ""
	def hostname = ""
	def port = ""
	def servletPath = ""
	def description = ""
	if(value.servlet != null &amp;&amp;  value.servlet != []){
		arr_str = value.servlet.split(":")
		hostname = arr_str[1].replace("//","")
		port = arr_str[2].substring(0,arr_str[2].indexOf("/"))
		servletPath = arr_str[2].substring(arr_str[2].indexOf("/")+1)
	}
	if(value.desc != null &amp;&amp; value.desc != []){
		description = value.desc
	} else {
		description = "No description"
	}
	println "&lt;tr&gt;&lt;td&gt;$key&lt;/td&gt;&lt;td&gt;$hostname&lt;/td&gt;&lt;td&gt;$port&lt;/td&gt;&lt;td&gt;$servletPath&lt;/td&gt;&lt;td&gt;$description&lt;/td&gt;&lt;td style='width:120px,text-align:center'&gt;&lt;input type='button' style='width:50px' value='Delete' class='delete button'/&gt;&lt;input type='button' value='Edit' style='width:50px' class='edit button'/&gt;&lt;/td&gt;&lt;/tr&gt;" 
	}
println "&lt;tr id='input'&gt;&lt;td&gt;&lt;input type='text' id = 'name' /&gt;&lt;/td&gt;&lt;td&gt;&lt;input type='text' id = 'host' /&gt;&lt;/td&gt;&lt;td&gt;&lt;input type='text' id = 'port' /&gt;&lt;/td&gt;&lt;td&gt;&lt;input type='text' id = 'servlet' /&gt;&lt;/td&gt;&lt;td&gt;&lt;textarea type='text' width='auto' id='desc'/&gt;&lt;/textarea&gt;&lt;/td&gt;&lt;/tr&gt;"
println "&lt;/table&gt;"
println "{{html wiki = 'false' clean = 'true'}}"
println "&lt;textarea id='result' name = 'result' style='display: none' readonly&gt;$str_json&lt;/textarea&gt;"
println "&lt;input type='button' id='add' style='width:50px' class='button' value='Add'/&gt;"
println "&lt;input type='submit' id='create' style='width:50px' class='button' value='Create'/&gt;"
println "{{/html}}"
println "&lt;/form&gt;"
println "&lt;br/&gt;"
println "&lt;div class='message' id='message'&gt;"
	if(messServlet!=null){
		println messServlet
	}
println "&lt;/div&gt;"
println "&lt;div&gt;&amp;nbsp;&lt;/div&gt;"
println "&lt;div&gt;&amp;nbsp;&lt;/div&gt;"

{{/groovy}}

{{html}}
&lt;form id = 'wiperdogPath' action = '' method = 'POST' enctype='multipart/form-data' &gt;
	&lt;div class= 'header'&gt;WiperDog Path Configuration&lt;/div&gt;
	&lt;br/&gt;
	&lt;label &gt;Operating System&lt;/label&gt;
	&lt;br/&gt;
	&lt;input type='radio' name='os' value='linux'/&gt;Linux
	&lt;input type='radio' name='os' value='win'/&gt;Windows
	&lt;br/&gt;
	&lt;label for='host'&gt;Host&lt;/label&gt;
	&lt;br/&gt;
	&lt;input type='radio' name='hostSelect' value='local' /&gt;Local host
	&lt;input type='radio' name='hostSelect' value='other' /&gt;Other host
	&lt;br/&gt;
	&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;input type='text' value='' id='remoteHost' name='remoteHost'/&gt;
        &lt;br/&gt;
	&lt;label for='uName' class='u'&gt;Username&lt;/label&gt;
	&lt;input type='text' value='' id='uName' class='u' name='usName' autocomplete = 'false'/&gt;
	&lt;br/&gt;
	&lt;label for='passwd' class='p'&gt;Password&lt;/label&gt;
	&lt;input type='password' value='' id='passwd' class='p' name='pswd' autocomplete = 'false' /&gt;

	&lt;div&gt;&amp;nbsp;&lt;/div&gt;
	&lt;label for = 'dir'&gt;Current Wiperdog path :&lt;/label&gt;
	&lt;input type ='text' id = 'dir' name = 'wdDir' /&gt;
	&lt;input type = 'button' id = 'updateWDPath' class='button' value = 'UPDATE'/&gt;
	&lt;br&gt;&lt;input type="checkbox" name="installSysService" value="installSysService" id="installSysService"&gt;Install the new Wiperdog as system service and Restart service&lt;/checkbox&gt;
&lt;/form&gt;
&lt;br/&gt;
&lt;div class='message' id='messageWiperdog' style='display:none'&gt;
	&lt;p&gt;Log: &lt;p&gt;
	&lt;textarea id='log' readonly = 'true' style='width: 500px;height: 300px;overflow: scroll' &gt;&lt;/textarea&gt;
&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;br/&gt;
{{/html}}</content>
</xwikidoc>
